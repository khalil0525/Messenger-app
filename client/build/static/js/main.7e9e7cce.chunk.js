(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{143:function(e,t,n){},202:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(14),s=n.n(c),o=(n(143),n(6)),i=n(11),l=n(246),u=n(19),d=n(125),b=Object(d.a)({typography:{fontFamily:"Open Sans, sans-serif",fontSize:14,button:{textTransform:"none",letterSpacing:0,fontWeight:"bold"}},overrides:{MuiInput:{input:{fontWeight:"bold"}}},palette:{primary:{main:"#3A8DFF"},secondary:{main:"#B0B0B0"}}}),j=n(18),p=n(10),f=n(20),h=n.n(f),m=n(17),x=n(13),g=n(230),O=n(232),v=n(248),y=n(127),w=n(1),C=Object(g.a)((function(e){var t;return{root:{height:"100vh"},bgGrid:{backgroundSize:"cover",backgroundImage:"url(https://source.unsplash.com/random)",backgroundRepeat:"no-repeat",backgroundPosition:"center"},bgBox:(t={},Object(x.a)(t,e.breakpoints.down("xs"),{display:"none"}),Object(x.a)(t,e.breakpoints.up("sm"),{display:"flex"}),Object(x.a)(t,"minHeight","100vh"),Object(x.a)(t,"alignItems","center"),Object(x.a)(t,"flexDirection","column"),Object(x.a)(t,"backgroundSize","cover"),Object(x.a)(t,"justifyContent","center"),Object(x.a)(t,"backgroundImage","linear-gradient(180deg, rgb(58,141,255, 0.75) 0%, rgb(134,185,255, 0.75) 100%)"),Object(x.a)(t,"backgroundPosition","center"),t),text:{color:"#ffffff",maxWidth:"300px",marginTop:"30px",textAlign:"center"}}})),k=function(e){var t=e.WrappedComponent,n=C();return Object(w.jsxs)(O.a,{container:!0,className:n.root,children:[Object(w.jsx)(O.a,{item:!0,xs:!1,sm:4,md:7,className:n.bgGrid,children:Object(w.jsxs)(v.a,{className:n.bgBox,children:[Object(w.jsx)("img",{width:"67",src:"https://res.cloudinary.com/dna1o7hrm/image/upload/v1612406581/r1hhd9ry5wxux0tqhju0.png",alt:"chat bubble"}),Object(w.jsx)(y.a,{variant:"h4",className:n.text,children:"Welcome to ChatApp"})]})}),Object(w.jsx)(O.a,{item:!0,xs:12,sm:8,md:5,children:t})]})},S=n(234),N=n(235),I=n(247),T=n(238),U=Object(g.a)((function(e){return{root:{height:"100vh"},headerContainer:{display:"flex",alignItems:"flex-start",paddingTop:"23px",flexDirection:"column",justifyContent:"space-between"},headerInner:{padding:"8px",alignSelf:"center",alignItems:"center"},headerContent:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center"},contentContainer:{display:"flex",margin:"64px 32px",alignItems:"center",justifyContent:"center",flexDirection:"column"},text:{color:"#b0b0b0",textAlign:"center",fontWeight:"400",whiteSpace:"nowrap",marginRight:"21px"},formBox:{display:"flex",margin:"64px 32px",alignItems:"center",flexDirection:"column"},welcomeText:{color:"#000000",fontSize:"26px",fontWeight:"600",paddingBottom:"20px"}}})),P=function(e){var t=e.user,n=e.register,a=Object(m.g)(),c=U(),s=Object(r.useState)({}),l=Object(p.a)(s,2),d=l[0],b=l[1],j=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,c,s,i,l;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=t.currentTarget,a=r.elements,c=a.username.value,s=a.email.value,i=a.password.value,l=a.confirmPassword.value,i===l){e.next=10;break}return b({confirmPassword:"Passwords must match"}),e.abrupt("return");case 10:return e.next=12,n({username:c,email:s,password:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){t&&t.id&&t.active&&a.push("/home")}),[t,a]),Object(r.useEffect)((function(){t&&t.id&&!t.active&&a.push("/")}),[t,a]),Object(w.jsx)(O.a,{container:!0,justifyContent:"center",className:c.root,children:Object(w.jsxs)(v.a,{children:[Object(w.jsx)(v.a,{container:!0,className:c.headerContainer,children:Object(w.jsx)(v.a,{className:c.headerInner,children:Object(w.jsxs)(v.a,{className:c.headerContent,children:[Object(w.jsx)(y.a,{variant:"body1",className:c.text,children:"Need to log in?"}),Object(w.jsx)(S.a,{component:u.b,to:"/login",children:"Login"})]})})}),Object(w.jsx)(v.a,{className:c.contentContainer,children:Object(w.jsxs)(O.a,{container:!0,justifyContent:"center",alignItems:"center",className:c.formBox,children:[Object(w.jsx)(y.a,{variant:"h4",className:c.welcomeText,children:"Register your account"}),Object(w.jsx)("form",{onSubmit:j,className:c.form,children:Object(w.jsxs)(O.a,{container:!0,spacing:2,children:[Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(N.a,{fullWidth:!0,children:Object(w.jsx)(I.a,{"aria-label":"username",label:"Username",name:"username",type:"text",required:!0})})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(N.a,{fullWidth:!0,children:Object(w.jsx)(I.a,{label:"E-mail address","aria-label":"e-mail address",type:"email",name:"email",required:!0})})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsxs)(N.a,{error:!!d.confirmPassword,fullWidth:!0,children:[Object(w.jsx)(I.a,{"aria-label":"password",label:"Password",type:"password",inputProps:{minLength:6},name:"password",required:!0}),Object(w.jsx)(T.a,{children:d.confirmPassword})]})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsxs)(N.a,{error:!!d.confirmPassword,fullWidth:!0,children:[Object(w.jsx)(I.a,{label:"Confirm Password","aria-label":"confirm password",type:"password",inputProps:{minLength:6},name:"confirmPassword",required:!0}),Object(w.jsx)(T.a,{children:d.confirmPassword})]})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,children:"Create"})})]})})]})})]})})},W=n(239),B=Object(g.a)((function(e){return{root:{height:"100vh"},headerContainer:{display:"flex",alignItems:"flex-start",paddingTop:"23px",flexDirection:"column",justifyContent:"space-between"},headerInner:{padding:"8px",alignSelf:"center",alignItems:"center"},headerContent:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center"},contentContainer:{display:"flex",margin:"64px 32px",alignItems:"center",justifyContent:"center",flexDirection:"column"},text:{color:"#b0b0b0",textAlign:"center",fontWeight:"400",whiteSpace:"nowrap",marginRight:"21px"},formBox:{display:"flex",margin:"64px 32px",alignItems:"center",flexDirection:"column"},welcomeText:{color:"#000000",fontSize:"26px",fontWeight:"600",paddingBottom:"20px"},forgotPasswordLink:{marginTop:e.spacing(2),color:e.palette.primary.main,textDecoration:"none","&:hover":{textDecoration:"underline"}}}})),D=function(e){var t=e.user,n=e.login,a=Object(m.g)(),c=B(),s=Object(r.useState)(!1),l=Object(p.a)(s,2),d=l[0],b=l[1],j=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a,c,s;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=t.currentTarget,a=r.elements,c=a.username.value,s=a.password.value,b(!0),e.prev=6,e.next=9,n({username:c,password:s});case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(6);case 13:return e.prev=13,b(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[6,11,13,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){t&&t.id&&t.active&&a.push("/home")}),[t,a]),Object(r.useEffect)((function(){t&&t.id&&!t.active&&a.push("/")}),[t,a]),Object(w.jsx)(O.a,{container:!0,justifyContent:"center",className:c.root,children:Object(w.jsxs)(v.a,{children:[Object(w.jsx)(v.a,{container:!0,item:!0,className:c.headerContainer,children:Object(w.jsx)(v.a,{className:c.headerInner,children:Object(w.jsxs)(v.a,{className:c.headerContent,children:[Object(w.jsx)(y.a,{variant:"body1",className:c.text,children:"Need to register?"}),Object(w.jsx)(u.b,{href:"/register",to:"/register",children:Object(w.jsx)(S.a,{children:"Register"})})]})})}),Object(w.jsx)(v.a,{className:c.contentContainer,children:Object(w.jsxs)(O.a,{container:!0,justifyContent:"center",alignItems:"center",className:c.formBox,children:[Object(w.jsx)(y.a,{variant:"h4",className:c.welcomeText,children:"Welcome Back!"}),Object(w.jsx)("form",{onSubmit:j,className:c.form,children:Object(w.jsxs)(O.a,{container:!0,spacing:2,children:[Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(N.a,{margin:"normal",required:!0,fullWidth:!0,children:Object(w.jsx)(I.a,{"aria-label":"username",label:"Username",name:"username",type:"text",variant:"outlined"})})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(N.a,{margin:"normal",required:!0,fullWidth:!0,children:Object(w.jsx)(I.a,{label:"Password","aria-label":"password",type:"password",name:"password",variant:"outlined"})})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",size:"large",disabled:d,fullWidth:!0,children:"Login"})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(W.a,{component:u.b,to:"/password-recovery",className:c.forgotPasswordLink,children:"Forgot your password?"})})]})})]})})]})})},R=Object(g.a)((function(e){return{root:{height:"100vh",backgroundColor:e.palette.background.default},contentContainer:{display:"flex",margin:"64px 32px",alignItems:"center",justifyContent:"center",flexDirection:"column"},welcomeText:{color:e.palette.primary.main,fontSize:"26px",fontWeight:"600",marginBottom:e.spacing(3)},form:{width:"100%",maxWidth:"400px",padding:e.spacing(3),borderRadius:e.spacing(1),backgroundColor:e.palette.background.paper,boxShadow:e.shadows[3]},submitButton:{marginTop:e.spacing(3)},statusText:{marginTop:e.spacing(2),color:e.palette.error.main}}})),E=function(e){var t=e.recoveryChangePassword,n=R(),a=Object(r.useState)(""),c=Object(p.a)(a,2),s=c[0],l=c[1],u=Object(r.useState)(""),d=Object(p.a)(u,2),b=d[0],j=d[1],f=Object(r.useState)(""),h=Object(p.a)(f,2),x=h[0],g=h[1],v=Object(m.h)(),C=new URLSearchParams(v.search).get("token"),k=Object(m.g)(),T=function(){var e=Object(i.a)(Object(o.a)().mark((function e(n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),s===b){e.next=4;break}return g("Passwords do not match. Please try again."),e.abrupt("return");case 4:return e.prev=4,e.next=7,t(C,s);case 7:g("Password changed successfully."),setTimeout((function(){k.push("/")}),3e3),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),g("Failed to change password.");case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(O.a,{container:!0,justifyContent:"center",className:n.root,children:Object(w.jsxs)("div",{className:n.form,children:[Object(w.jsx)(y.a,{variant:"h4",className:n.welcomeText,children:"Change Password"}),Object(w.jsxs)("form",{onSubmit:T,children:[Object(w.jsx)(N.a,{margin:"normal",required:!0,children:Object(w.jsx)(I.a,{label:"New Password","aria-label":"new-password",type:"password",value:s,onChange:function(e){return l(e.target.value)},fullWidth:!0})}),Object(w.jsx)(N.a,{margin:"normal",required:!0,children:Object(w.jsx)(I.a,{label:"Confirm Password","aria-label":"confirm-password",type:"password",value:b,onChange:function(e){return j(e.target.value)},fullWidth:!0})}),Object(w.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",className:n.submitButton,fullWidth:!0,children:"Change Password"})]}),Object(w.jsx)(y.a,{variant:"body2",className:n.statusText,children:x})]})})},F=Object(g.a)((function(e){return{root:{height:"100vh"},contentContainer:{display:"flex",margin:"64px 32px",alignItems:"center",justifyContent:"center",flexDirection:"column"},welcomeText:{color:"#000000",fontSize:"26px",fontWeight:"600",paddingBottom:"20px"},resendButton:{marginTop:e.spacing(2)}}})),L=function(e){var t=e.user,n=e.resendVerification,a=F(),c=Object(r.useState)(""),s=Object(p.a)(c,2),l=s[0],u=s[1],d=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t);case 3:u("Verification link resent! Check your email."),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),u("Failed to resend verification link.");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsx)(O.a,{container:!0,justifyContent:"center",className:a.root,children:Object(w.jsx)(v.a,{className:a.contentContainer,children:Object(w.jsxs)(O.a,{container:!0,justifyContent:"center",direction:"column",children:[Object(w.jsx)(y.a,{variant:"body1",className:a.welcomeText,children:"You must verify your email to access the application."}),Object(w.jsx)(y.a,{variant:"body2",children:l}),Object(w.jsx)(S.a,{variant:"contained",color:"primary",className:a.resendButton,onClick:d,children:"Resend Verification Link"})]})})})},A=Object(g.a)((function(e){return{root:{height:"100vh"},headerContainer:{display:"flex",alignItems:"flex-start",paddingTop:"23px",flexDirection:"column",justifyContent:"space-between"},headerInner:{padding:"8px",alignSelf:"center",alignItems:"center"},headerContent:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center"},contentContainer:{display:"flex",margin:"64px 32px",alignItems:"center",justifyContent:"center",flexDirection:"column"},text:{color:"#b0b0b0",textAlign:"center",fontWeight:"400",whiteSpace:"nowrap",marginRight:"21px"},formBox:{display:"flex",margin:"64px 32px",alignItems:"center",flexDirection:"column"},welcomeText:{color:"#000000",fontSize:"26px",fontWeight:"600",paddingBottom:"20px"},statusText:{marginTop:e.spacing(2),color:e.palette.text.secondary,textAlign:"center"}}})),z=function(e){var t=e.recoverPassword,n=A(),a=Object(r.useState)(""),c=Object(p.a)(a,2),s=c[0],l=c[1],d=Object(r.useState)(""),b=Object(p.a)(d,2),j=b[0],f=b[1],h=Object(m.g)(),x=Object(r.useState)(!1),g=Object(p.a)(x,2),C=g[0],k=g[1],T=function(){var e=Object(i.a)(Object(o.a)().mark((function e(n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),k(!0),e.prev=2,e.next=5,t(s);case 5:f("Password recovery instructions sent to your email."),setTimeout((function(){h.push("/login")}),3e3),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),f("Failed to initiate password recovery.");case 12:return e.prev=12,k(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(O.a,{container:!0,justifyContent:"center",className:n.root,children:Object(w.jsxs)(v.a,{children:[Object(w.jsx)(v.a,{container:!0,className:n.headerContainer,children:Object(w.jsx)(v.a,{className:n.headerInner,children:Object(w.jsxs)(v.a,{className:n.headerContent,children:[Object(w.jsx)(y.a,{variant:"body1",className:n.text,children:"Need to log in?"}),Object(w.jsx)(S.a,{component:u.b,to:"/login",children:"Login"})]})})}),Object(w.jsxs)(v.a,{className:n.contentContainer,children:[Object(w.jsxs)(O.a,{container:!0,justifyContent:"center",alignItems:"center",className:n.formBox,children:[Object(w.jsx)(y.a,{variant:"h4",className:n.welcomeText,children:"Recover Password"}),Object(w.jsx)("form",{className:n.form,onSubmit:T,children:Object(w.jsxs)(O.a,{container:!0,spacing:2,children:[Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(N.a,{fullWidth:!0,margin:"normal",required:!0,children:Object(w.jsx)(I.a,{label:"Email","aria-label":"email",type:"email",variant:"outlined",value:s,onChange:function(e){return l(e.target.value)}})})}),Object(w.jsx)(O.a,{item:!0,xs:12,children:Object(w.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,disabled:C,children:"Send Recovery Email"})})]})})]}),Object(w.jsx)(y.a,{variant:"body2",className:n.statusText,children:j})]})]})})},M=n(24),_=n(245),q=n(240),G=Object(g.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",marginLeft:20,flexGrow:1},username:{fontWeight:"bold",letterSpacing:-.2,color:"rgb(255, 255, 255)"},previewText:{fontSize:14,fontWeight:"300",color:"rgb(255, 255, 255, 50%)",letterSpacing:-.17},boldPreviewText:{color:"rgb(255, 255, 255, 50%)",fontWeight:"600"},badgeRoot:{alignSelf:"center",marginRight:40},badgeInner:{backgroundColor:"rgb(245, 99, 101, 100%)",color:"#fff",fontSize:12,fontWeight:"bold"}}})),H=function(e){var t,n,a=e.conversation,c=G(),s=a.otherUser,o=a.id&&a.latestMessageText,i=(null===(t=a.messages[a.messages.length-1])||void 0===t?void 0:t.senderId)===s.id&&!(null!==(n=a.messages[a.messages.length-1])&&void 0!==n&&n.isRead),l=Object(r.useMemo)((function(){return i?a.messages.filter((function(e){return!e.isRead})).length:0}),[a.messages,i]);return Object(w.jsxs)(v.a,{className:c.root,children:[Object(w.jsxs)(v.a,{children:[Object(w.jsx)(y.a,{className:c.username,children:s.username}),Object(w.jsx)(y.a,{className:"".concat(i&&c.boldPreviewText," ").concat(c.previewText),children:o})]}),Object(w.jsx)(q.a,{badgeContent:l,classes:{root:c.badgeRoot,badge:c.badgeInner}})]})},V=n(241),K=n(242),Y=n(249),J=n(237),Q=n(243),$=n(250),X=n(251),Z=n(76),ee=n.n(Z),te=Object(g.a)((function(){return{ellipsis:{color:"#95A7C4",marginRight:24,opacity:.9},popper:{zIndex:1e3,marginRight:"8px"}}}));function ne(e){var t=e.handleLogout,n=te(),a=Object(r.useState)(!1),c=Object(p.a)(a,2),s=c[0],o=c[1],i=Object(r.useRef)(),l=function(e){i.current&&i.current.contains(e.target)||o(!1)};function d(e){"Tab"===e.key?(e.preventDefault(),o(!1)):"Escape"===e.key&&o(!1)}var b=Object(r.useRef)(s);return Object(r.useEffect)((function(){!0===b.current&&!1===s&&i.current.focus(),b.current=s}),[s]),Object(w.jsx)(v.a,{display:"flex",alignItems:"center",spacing:2,className:n.root,children:Object(w.jsxs)("div",{children:[Object(w.jsx)(V.a,{disableRipple:!0,disableFocusRipple:!0,ref:i,id:"composition-button","aria-controls":s?"composition-menu":void 0,"aria-expanded":s?"true":void 0,"aria-haspopup":"true",onClick:function(){o((function(e){return!e}))},children:Object(w.jsx)(ee.a,{classes:{root:n.ellipsis}})}),Object(w.jsx)(K.a,{open:s,anchorEl:i.current,role:void 0,placement:"bottom-start",transition:!0,disablePortal:!0,className:n.popper,children:function(e){var n=e.TransitionProps,r=e.placement;return Object(w.jsx)(Y.a,Object(j.a)(Object(j.a)({},n),{},{style:{transformOrigin:"bottom-start"===r?"left top":"left bottom"},children:Object(w.jsx)(J.a,{children:Object(w.jsx)(Q.a,{onClickAway:l,children:Object(w.jsxs)($.a,{autoFocusItem:s,id:"composition-menu","aria-labelledby":"composition-button",onKeyDown:d,children:[Object(w.jsx)(X.a,{component:u.b,to:"/profile",onClick:l,children:"Profile"}),Object(w.jsx)(X.a,{component:u.b,to:"/account",onClick:l,children:"My account"}),Object(w.jsx)(X.a,{onClick:function(){return t()},children:"Logout"})]})})})}))}})]})})}var re=Object(g.a)((function(){return{root:{height:44,marginTop:23,marginLeft:6,display:"flex",alignItems:"center"},subContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},username:{letterSpacing:-.23,fontSize:20,fontWeight:"bold",marginLeft:17,color:"#fff"},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),ae=function(e){var t=e.user,n=e.handleLogout,r=re();return Object(w.jsxs)(v.a,{className:r.root,children:[Object(w.jsx)(xe,{photoUrl:null===t||void 0===t?void 0:t.photoUrl,online:!0}),Object(w.jsxs)(v.a,{className:r.subContainer,children:[Object(w.jsx)(y.a,{className:r.username,children:null===t||void 0===t?void 0:t.username}),Object(w.jsx)(ne,{handleLogout:n})]})]})},ce=n(236),se=n(244),oe=n(120),ie=n.n(oe),le=Object(g.a)((function(){return{filledInput:{height:50,background:"rgb(18, 22, 23)",borderRadius:5,fontSize:13,fontWeight:"bold",color:"#99A9C4",letterSpacing:0,display:"flex",justifyContent:"center",marginTop:20,marginBottom:20},input:{"&::placeholder":{color:"#ADC0DE",opacity:1}}}})),ue=function(e){var t=e.handleChange,n=le();return Object(w.jsx)("form",{onSubmit:function(e){e.preventDefault()},children:Object(w.jsx)(N.a,{fullWidth:!0,hiddenLabel:!0,children:Object(w.jsx)(ce.a,{name:"search",onChange:t,classes:{root:n.filledInput,input:n.input},disableUnderline:!0,placeholder:"Search",startAdornment:Object(w.jsx)(se.a,{position:"start",children:Object(w.jsx)(ie.a,{})})})})})},de=Object(g.a)((function(){return{root:{paddingLeft:16,paddingRight:16,flexGrow:1,backgroundColor:"rgba(8,10,25,255)"},title:{fontSize:16,letterSpacing:-.29,fontWeight:"bold",marginTop:32,marginBottom:15,color:"rgba(255, 255, 255, 30%)"}}})),be=function(e){var t=e.handleChange,n=e.searchTerm,r=e.conversations,a=void 0===r?[]:r,c=e.user,s=e.setActiveChat,o=e.handleLogout,i=de();return Object(w.jsxs)(v.a,{className:i.root,children:[Object(w.jsx)(ae,{user:c,handleLogout:o}),Object(w.jsx)(ue,{handleChange:t}),Object(w.jsx)(y.a,{className:i.title,children:"PINNED"}),Object(w.jsx)(y.a,{className:i.title,children:"DIRECT MESSAGES"}),a.filter((function(e){return e.otherUser.username.includes(n)})).map((function(e){return Object(w.jsx)(fe,{conversation:e,setActiveChat:s},e.otherUser.username)})),Object(w.jsx)(y.a,{className:i.title,children:"GROUP MESSAGES"}),Object(w.jsx)(y.a,{className:i.title,children:"FRIEND REQUESTS"})]})},je=function(e){var t=e.conversations,n=e.user,a=e.clearSearchedUsers,c=e.addSearchedUsers,s=e.setActiveChat,l=e.handleLogout,u=Object(r.useState)(""),d=Object(p.a)(u,2),b=d[0],j=d[1],f=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("/api/users/".concat(t));case 3:n=e.sent,r=n.data,c(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.target.value){e.next=4;break}return a(),j(""),e.abrupt("return");case 4:if(!b.includes(t.target.value)){e.next=7;break}return j(t.target.value),e.abrupt("return");case 7:return e.next=9,f(t.target.value);case 9:j(t.target.value);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(be,{handleChange:m,searchTerm:b,conversations:t,user:n,setActiveChat:s,handleLogout:l})},pe=Object(g.a)((function(e){return{root:{borderRadius:8,height:80,marginBottom:10,display:"flex",alignItems:"center","&:hover":{cursor:"grab"}}}})),fe=function(e){var t=e.conversation,n=e.setActiveChat,r=pe(),a=t.otherUser,c=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t.otherUser.username);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(v.a,{onClick:function(){return c(t)},className:r.root,children:[Object(w.jsx)(xe,{photoUrl:a.photoUrl,username:a.username,online:a.online,sidebar:!0}),Object(w.jsx)(H,{conversation:t})]})},he=n(252),me=Object(g.a)((function(){return{profilePic:{height:44,width:44},badge:{height:13,width:13,borderRadius:"50%",border:"2px solid rgba(8,10,25,255)",backgroundColor:"#D0DAE9"},online:{backgroundColor:"#1CED84"},sidebar:{marginLeft:17}}})),xe=function(e){var t=e.sidebar,n=e.username,r=e.photoUrl,a=e.online,c=me();return Object(w.jsx)(v.a,{className:t?c.sidebar:"",children:Object(w.jsx)(q.a,{classes:{badge:"".concat(c.badge," ").concat(a&&c.online)},variant:"dot",anchorOrigin:{horizontal:"left",vertical:"top"},overlap:"circular",children:Object(w.jsx)(he.a,{alt:n,src:r,className:c.profilePic})})})},ge=Object(g.a)((function(){return{root:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",marginBottom:10},contentContainer:{display:"flex",flexDirection:"column",alignItems:"flex-end"},avatar:{height:40,width:40,marginLeft:10},username:{fontSize:11,color:"rgba(79, 127, 183, 100%)",fontWeight:"bold",marginBottom:5},date:{fontSize:11,color:"rgba(255, 255, 255, 50%)",fontWeight:"bold",marginBottom:5},bubble:{background:"rgba(66, 104, 149, 42%)",borderRadius:"10px 10px 0 10px",padding:6,paddingLeft:10,display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"start",minWidth:"140px"},bubbleHeader:{display:"flex",justifyContent:"space-between",width:"100%"},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2},readAvatar:{height:20,width:20,marginTop:9}}})),Oe=function(e){var t=e.time,n=e.text,r=e.otherUser,a=e.isLastReadMessage,c=e.user,s=ge();return Object(w.jsxs)(v.a,{className:s.root,children:[Object(w.jsxs)(v.a,{className:s.contentContainer,children:[Object(w.jsxs)(v.a,{className:s.bubble,children:[Object(w.jsxs)(v.a,{className:s.bubbleHeader,children:[" ",Object(w.jsx)(y.a,{className:s.username,children:c.username}),Object(w.jsx)(y.a,{className:s.date,children:t})]}),Object(w.jsx)(y.a,{className:s.text,children:n})]}),a&&Object(w.jsx)(he.a,{alt:r.username,src:r.photoUrl,className:s.readAvatar})]}),Object(w.jsx)(he.a,{alt:r.username,src:c.photoUrl,className:s.avatar})]})},ve=Object(g.a)((function(){return{root:{display:"flex",marginBottom:10},avatar:{height:40,width:40,marginRight:11,alignSelf:"flex-end"},username:{fontSize:11,color:"rgba(79, 127, 183, 100%)",fontWeight:"bold",marginBottom:5},date:{fontSize:11,color:"rgba(255, 255, 255, 50%)",fontWeight:"bold",marginBottom:5},bubble:{backgroundColor:"rgba(33, 35, 38, 60%)",borderRadius:"8px 10px 10px 2px",padding:6,paddingLeft:10,display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"start",minWidth:"140px"},bubbleHeader:{display:"flex",justifyContent:"space-between",width:"100%"},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2}}})),ye=function(e){var t=e.text,n=e.time,r=e.otherUser,a=ve();return Object(w.jsxs)(v.a,{className:a.root,children:[Object(w.jsx)(he.a,{alt:r.username,src:r.photoUrl,className:a.avatar}),Object(w.jsx)(v.a,{children:Object(w.jsxs)(v.a,{className:a.bubble,children:[Object(w.jsxs)(v.a,{className:a.bubbleHeader,children:[" ",Object(w.jsx)(y.a,{className:a.username,children:r.username}),Object(w.jsx)(y.a,{className:a.date,children:n})]}),Object(w.jsx)(y.a,{className:a.text,children:t})]})})]})},we=Object(g.a)((function(){return{root:{display:"flex",flexGrow:8,flexDirection:"column",borderLeft:"4px solid rgba(49,51,65,255)",backgroundColor:"rgba(8,28,26,255)"},chatContainer:{marginLeft:41,marginRight:41,display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"space-between"}}})),Ce=function(e){var t,n=e.user,a=e.conversations,c=e.activeConversation,s=e.postMessage,o=e.patchMessage,i=we(),l=Object(r.useMemo)((function(){return a?a.find((function(e){return e.otherUser.username===c})):{}}),[a,c]);return Object(r.useEffect)((function(){var e=(null===l||void 0===l?void 0:l.messages[l.messages.length-1])||{},t=e.senderId,n=e.isRead;l&&l.otherUser&&t===l.otherUser.id&&!n&&o(t)}),[l,o]),Object(w.jsx)(v.a,{className:i.root,children:(t=l,t!=={}&&void 0!==t&&l.otherUser&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Ie,{username:l.otherUser.username,online:l.otherUser.online||!1}),Object(w.jsx)(v.a,{className:i.chatContainer,children:n&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Pe,{messages:l.messages,otherUser:l.otherUser,userId:n.id,user:n}),Object(w.jsx)(Se,{otherUser:l.otherUser,conversationId:l.id||null,user:n,postMessage:s})]})})]}))})},ke=Object(g.a)((function(){return{root:{justifySelf:"flex-end",marginTop:15},input:{height:70,backgroundColor:"rgb(18, 22, 23)",color:"rgb(255, 255, 255)",borderRadius:8,marginBottom:20}}})),Se=function(e){var t=e.otherUser,n=e.conversationId,a=e.user,c=e.postMessage,s=ke(),l=Object(r.useState)(""),u=Object(p.a)(l,2),d=u[0],b=u[1],j=function(){var e=Object(i.a)(Object(o.a)().mark((function e(r){var s,i,l;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),s=r.currentTarget,i=s.elements,l={text:i.text.value,recipientId:t.id,conversationId:n,sender:n?null:a},e.next=6,c(l);case 6:b("");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)("form",{className:s.root,onSubmit:j,children:Object(w.jsx)(N.a,{fullWidth:!0,hiddenLabel:!0,children:Object(w.jsx)(ce.a,{classes:{root:s.input},disableUnderline:!0,placeholder:"Write a message...",value:d,name:"text",onChange:function(e){b(e.target.value)}})})})},Ne=Object(g.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between",height:89,marginBottom:34,boxShadow:"0 2px 20px 0 rgba(88,133,196,0.10)",borderBottom:"4px solid rgba(49,51,65,255)",backgroundColor:"rgba(8,10,25,255)"},content:{display:"flex",alignItems:"center",marginLeft:24},username:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginRight:14,color:"rgb(255, 255, 255)"},statusText:{fontSize:12,color:"#BFC9DB",letterSpacing:-.17},statusDot:{height:8,width:8,borderRadius:"50%",marginRight:5,backgroundColor:"#D0DAE9"},online:{background:"#1CED84"},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),Ie=function(e){var t=e.username,n=e.online,r=Ne();return Object(w.jsxs)(v.a,{className:r.root,children:[Object(w.jsxs)(v.a,{className:r.content,children:[Object(w.jsx)(y.a,{className:r.username,children:t}),Object(w.jsx)(v.a,{className:"".concat(r.statusDot," ").concat(n&&r.online)}),Object(w.jsx)(y.a,{className:r.statusText,children:n?"Online":"Offline"})]}),Object(w.jsx)(ee.a,{classes:{root:r.ellipsis}})]})},Te=n(121),Ue=n.n(Te),Pe=function(e){var t=e.messages,n=e.otherUser,a=e.userId,c=e.user,s=Object(r.useMemo)((function(){for(var e=t.length-1;e>=0;e--)if(t[e].isRead&&t[e].senderId===a)return t[e].id;return 0}),[t,a]);return Object(w.jsx)(v.a,{children:t.map((function(e){var t=Ue()(e.createdAt).format("h:mm");return e.senderId===a?Object(w.jsx)(Oe,{text:e.text,time:t,user:c,otherUser:n,isLastReadMessage:s===e.id},e.id):Object(w.jsx)(ye,{text:e.text,time:t,otherUser:n},e.id)}))})},We=n(122),Be=Object(We.io)(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL);Be.on("connect",(function(){console.log("connected to server")}));var De=a.a.createContext(),Re=Object(g.a)((function(e){return{root:{height:"100vh"}}})),Ee=function(e){var t=e.user,n=e.logout,a=(e.setUser,Object(m.g)()),c=Object(r.useContext)(De),s=Object(r.useState)([]),l=Object(p.a)(s,2),u=l[0],d=l[1],b=Object(r.useState)(null),f=Object(p.a)(b,2),x=f[0],g=f[1],v=Re(),y=Object(r.useState)(!1),C=Object(p.a)(y,2),k=C[0],S=C[1],N=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/messages",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.patch("/api/messages/read/".concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e,t){c.emit("new-message",{message:e.message,recipientId:t.recipientId,sender:e.sender})},U=function(e){c.emit("read-messages",{messages:e.messages,recipientId:e.userId,sender:e.senderId})},P=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I(t);case 3:n=e.sent,W(n),U(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),W=Object(r.useCallback)((function(e){var t=e.messages,n=t[0].conversationId;d((function(e){return e.map((function(e){if(e.id===n){var r=Object(j.a)({},e);return r.messages=[].concat(Object(M.a)(r.messages.slice(0,r.messages.length-t.length)),Object(M.a)(t)),r}return e}))}))}),[]),B=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(t);case 3:n=e.sent,t.conversationId?R(n):D(t.recipientId,n.message),T(n,t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),D=Object(r.useCallback)((function(e,t){d((function(n){return n.map((function(n){if(n.otherUser.id===e){var r=Object(j.a)({},n);return r.messages=[t],r.latestMessageText=t.text,r.id=t.conversationId,r}return n}))}))}),[]),R=Object(r.useCallback)((function(e){var t=e.message,n=e.sender,r=void 0===n?null:n;if(null!==r){var a={id:t.conversationId,otherUser:r,messages:[t],latestMessageText:t.text};d((function(e){return[a].concat(Object(M.a)(e))}))}else d((function(e){return e.map((function(e){if(e.id===t.conversationId){var n=Object(j.a)({},e);return n.messages=[].concat(Object(M.a)(n.messages),[t]),n.latestMessageText=t.text,n}return e}))}))}),[]),E=Object(r.useCallback)((function(e){d((function(t){return t.map((function(t){if(t.otherUser.id===e){var n=Object(j.a)({},t);return n.otherUser=Object(j.a)(Object(j.a)({},n.otherUser),{},{online:!0}),n}return t}))}))}),[]),F=Object(r.useCallback)((function(e){d((function(t){return t.map((function(t){if(t.otherUser.id===e){var n=Object(j.a)({},t);return n.otherUser=Object(j.a)(Object(j.a)({},n.otherUser),{},{online:!1}),n}return t}))}))}),[]);Object(r.useEffect)((function(){return c.on("add-online-user",E),c.on("remove-offline-user",F),c.on("new-message",R),c.on("read-messages",W),function(){c.off("add-online-user",E),c.off("remove-offline-user",F),c.off("new-message",R),c.off("read-messages",W)}}),[R,W,E,F,c]),Object(r.useEffect)((function(){null!==t&&void 0!==t&&t.isFetching||(t&&t.id?S(!0):k?a.push("/login"):a.push("/register"))}),[t,a,k]),Object(r.useEffect)((function(){var e=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("/api/conversations");case 3:t=e.sent,n=t.data,d(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();t.isFetching||e()}),[t]);var L=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.id){e.next=3;break}return e.next=3,n(t.id);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(O.a,{container:!0,component:"main",className:v.root,children:[Object(w.jsx)(_.a,{}),Object(w.jsx)(je,{conversations:u,user:t,clearSearchedUsers:function(){d((function(e){return e.filter((function(e){return e.id}))}))},addSearchedUsers:function(e){var t={};u.forEach((function(e){t[e.otherUser.id]=!0}));var n=Object(M.a)(u);e.forEach((function(e){if(!t[e.id]){var r={otherUser:e,messages:[]};n.push(r)}})),d(n)},setActiveChat:function(e){g(e)},handleLogout:L}),Object(w.jsx)(Ce,{activeConversation:x,conversations:u,user:t,postMessage:B,patchMessage:P})]})})},Fe=n(253),Le=n(123),Ae=n.n(Le),ze=n(124),Me=n.n(ze),_e=Object(g.a)((function(e){return{snackbar:{fontWeight:"bold"},icon:{color:"white"},success:{backgroundColor:"green"},error:{backgroundColor:"red"}}})),qe=function(e){var t=e.setSnackBarOpen,n=e.message,r=e.snackBarOpen,c=e.isError,s=_e(),o=c?Object(w.jsx)(Ae.a,{color:"secondary"}):Object(w.jsx)(Me.a,{});return Object(w.jsx)(Fe.a,{open:r,onClose:function(){return t(!1)},message:n||"An error occurred. Please try again.",action:Object(w.jsx)(a.a.Fragment,{children:Object(w.jsx)(S.a,{className:s.icon,size:"small",onClick:function(){return t(!1)},children:o})}),ContentProps:{classes:{root:c?s.error:s.success}}})},Ge=Object(g.a)((function(e){return{root:{height:"100vh"},contentContainer:{display:"flex",margin:"64px 32px",alignItems:"center",justifyContent:"center",flexDirection:"column"},successText:{color:"#000000",fontSize:"26px",fontWeight:"600",paddingBottom:"20px"},errorText:{color:"red",fontSize:"18px",paddingBottom:"20px"}}})),He=function(e){var t=e.checkVerification,n=Object(m.g)(),a=Object(m.h)(),c=Ge(),s=Object(r.useState)(""),o=Object(p.a)(s,2),i=o[0],l=o[1];return Object(r.useEffect)((function(){if(a.search){var e=new URLSearchParams(a.search).get("token");e?t(e).then((function(){l("success"),setTimeout((function(){n.push("/")}),5e3)})).catch((function(e){console.error(e),l("error"),setTimeout((function(){n.push("/")}),5e3)})):n.push("/")}else n.push("/")}),[n,a.search,t]),Object(w.jsx)(O.a,{container:!0,justifyContent:"center",className:c.root,children:Object(w.jsx)(v.a,{className:c.contentContainer,children:Object(w.jsx)(O.a,{container:!0,justifyContent:"center",direction:"column",children:"success"===i?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(y.a,{variant:"body1",className:c.successText,children:"Thank you, your account has been verified!"}),Object(w.jsx)(y.a,{variant:"body2",children:"You will be redirected to the home page shortly."})]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(y.a,{variant:"body1",className:c.errorText,children:"Email verification failed."}),Object(w.jsx)(y.a,{variant:"body2",children:"You will be redirected to the home page shortly."})]})})})})},Ve=Object(g.a)((function(e){return{root:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:e.spacing(4),position:"relative"},profilePhoto:{width:150,height:150,borderRadius:"50%",objectFit:"cover",marginBottom:e.spacing(2)},backButton:{position:"absolute",top:0,left:30,margin:e.spacing(1)}}})),Ke=function(e){var t=e.user,n=e.setUser,r=Ve(),a=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var r,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=new FormData).append("image",t),console.log(t),e.next=6,h.a.post("/api/user/update-photo",r);case 6:a=e.sent,n((function(e){return Object(j.a)(Object(j.a)({},e),{},{photoUrl:a.data.photoUrl})})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{className:r.root,children:[Object(w.jsx)(S.a,{component:u.b,to:"/home",variant:"contained",color:"default",className:r.backButton,children:"Back to Home"}),Object(w.jsx)("img",{src:t.photoUrl,alt:"Profile",className:r.profilePhoto}),Object(w.jsx)(y.a,{variant:"h5",gutterBottom:!0,children:t.username}),Object(w.jsx)(y.a,{variant:"body1",gutterBottom:!0,children:t.email}),Object(w.jsx)("input",{type:"file",accept:"image/*",id:"profile-photo-input",name:"image",style:{display:"none"},onChange:function(e){var t=e.target.files[0];t&&a(t)}}),Object(w.jsx)("label",{htmlFor:"profile-photo-input",children:Object(w.jsx)(S.a,{component:"span",variant:"contained",color:"primary",children:"Upload Profile Photo"})})]})},Ye=Object(g.a)((function(e){return{root:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:e.spacing(4),position:"relative"},backButton:{position:"absolute",top:0,left:30,margin:e.spacing(1)}}})),Je=function(e){var t=e.user,n=Ye();return Object(w.jsxs)("div",{className:n.root,children:[Object(w.jsx)(S.a,{component:u.b,to:"/home",variant:"contained",color:"default",className:n.backButton,children:"Back to Home"}),Object(w.jsxs)(y.a,{variant:"h5",gutterBottom:!0,children:[t.username,"'s Account"]}),Object(w.jsxs)(y.a,{variant:"body1",gutterBottom:!0,children:["Email: ",t.email]}),Object(w.jsx)(y.a,{variant:"body1",gutterBottom:!0,children:"Account settings and details can go here."})]})},Qe=Object(m.i)((function(e){var t=Object(r.useState)({isFetching:!0}),n=Object(p.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),l=Object(p.a)(s,2),u=l[0],d=l[1],b=Object(r.useState)(!1),f=Object(p.a)(b,2),x=f[0],g=f[1],O=Object(r.useState)(!1),v=Object(p.a)(O,2),y=v[0],C=v[1],S=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.post("/auth/login",t);case 3:return n=e.sent,r=n.data,e.next=7,localStorage.setItem("messenger-token",r.token);case 7:c(r),Be.emit("go-online",r.id),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),c({error:e.t0.response.data.error||"Server Error"}),d(e.t0.response.data.error),g(!0),C(!0);case 18:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.post("/auth/register",t);case 3:return n=e.sent,r=n.data,e.next=7,localStorage.setItem("messenger-token",r.token);case 7:c(r),Be.emit("go-online",r.id),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),c({error:e.t0.response.data.error||"Server Error"}),d(e.t0.response.data.error),g(!0),C(!0);case 18:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.post("/auth/password/recover",{email:t});case 3:d("Recovery email sent!"),g(!1),C(!0),e.next=14;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),d(e.t0.response.data.error),g(!0),C(!0);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.post("/auth/password/set/".concat(t),{newPassword:n});case 3:d("Password changed successfully"),g(!1),C(!0),e.next=14;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),d(e.t0.response.data.error),g(!0),C(!0);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.post("/auth/verify/resend",{user:t});case 3:n=e.sent,r=n.data,console.log(r),d("Verification resent!"),g(!1),C(!0),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),d(e.t0.response.data.error),g(!0),C(!0);case 17:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n,r;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("/auth/verify?token=".concat(t));case 3:return n=e.sent,r=n.data,e.next=7,localStorage.setItem("messenger-token",r.token);case 7:c(r),d("Email verified successfully!"),g(!1),C(!0),e.next=19;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),d("Email verification failed. Please try again."),g(!0),C(!0);case 19:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.delete("/auth/logout");case 3:return e.next=5,localStorage.removeItem("messenger-token");case 5:c({}),d("Succesfully logged out"),g(!1),C(!0),Be.emit("logout",t),e.next=18;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0),d(e.t0.response.data.error),g(!0),C(!0);case 18:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){var e=function(){var e=Object(i.a)(Object(o.a)().mark((function e(){var t,n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c((function(e){return Object(j.a)(Object(j.a)({},e),{},{isFetching:!0})})),e.prev=1,e.next=4,h.a.get("/auth/user");case 4:t=e.sent,n=t.data,c(n),n.id&&Be.emit("go-online",n.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:return e.prev=13,c((function(e){return Object(j.a)(Object(j.a)({},e),{},{isFetching:!1})})),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(r.useEffect)((function(){null!==a&&void 0!==a&&a.error&&("string"===typeof a.error?d(a.error):d("Internal Server Error. Please try again"),g(!0),C(!0))}),[null===a||void 0===a?void 0:a.error]),null!==a&&void 0!==a&&a.isFetching?Object(w.jsx)("div",{children:"Loading..."}):(console.log(a),Object(w.jsxs)(De.Provider,{value:Be,children:[y&&Object(w.jsx)(qe,{setSnackBarOpen:C,message:u,snackBarOpen:y,isError:x}),Object(w.jsxs)(m.d,{children:[Object(w.jsx)(m.b,{path:"/login",render:function(){return Object(w.jsx)(k,{WrappedComponent:Object(w.jsx)(D,{user:a,login:S})})}}),Object(w.jsx)(m.b,{path:"/register",render:function(){return Object(w.jsx)(k,{WrappedComponent:Object(w.jsx)(P,{user:a,register:N})})}}),Object(w.jsx)(m.b,{path:"/verify",render:function(){return!a||null===a||void 0===a||!a.id||null!==a&&void 0!==a&&a.active?Object(w.jsx)(m.a,{to:"/"}):Object(w.jsx)(He,{checkVerification:W})}}),Object(w.jsx)(m.b,{path:"/password-recovery",render:function(){return null!==a&&void 0!==a&&a.id&&null!==a&&void 0!==a&&a.active?Object(w.jsx)(m.a,{to:"/home"}):Object(w.jsx)(k,{WrappedComponent:Object(w.jsx)(z,{recoverPassword:I})})}}),Object(w.jsx)(m.b,{path:"/change-password",render:function(){return Object(w.jsx)(E,{recoveryChangePassword:T})}}),Object(w.jsx)(m.b,{exact:!0,path:"/",render:function(e){return null!==a&&void 0!==a&&a.id?null!==a&&void 0!==a&&a.active?Object(w.jsx)(Ee,{user:a,logout:B}):Object(w.jsx)(k,{WrappedComponent:Object(w.jsx)(L,{user:a,resendVerification:U})}):Object(w.jsx)(k,{WrappedComponent:Object(w.jsx)(D,{user:a,login:S})})}}),Object(w.jsx)(m.b,{path:"/home",render:function(){return Object(w.jsx)(Ee,{user:a,logout:B})}}),Object(w.jsx)(m.b,{path:"/profile",render:function(){return Object(w.jsx)(Ke,{user:a,setUser:c})}}),Object(w.jsx)(m.b,{path:"/account",render:function(){return Object(w.jsx)(Je,{user:a,setUser:c})}})]})]}))}));h.a.interceptors.request.use(function(){var e=Object(i.a)(Object(o.a)().mark((function e(t){var n;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("messenger-token");case 2:return n=e.sent,t.headers["x-access-token"]=n,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var $e=function(){return Object(w.jsx)(l.a,{theme:b,children:Object(w.jsx)(u.a,{children:Object(w.jsx)(Qe,{})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(w.jsx)($e,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[202,1,2]]]);
//# sourceMappingURL=main.7e9e7cce.chunk.js.map